<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NextVG OS</title>
<style>
* { box-sizing:border-box; user-select:none; }
html,body {
  margin:0; height:100%; width:100%;
  background:#050505;
  font-family:Segoe UI, system-ui;
  overflow:hidden;
}

#desktop {
  position:absolute;
  inset:0 0 48px 0;
  background:#070a10;
  background-size:cover;
  background-position:center;
}

.window {
  position:absolute;
  background:#0d1117;
  border:1px solid #1f2937;
  border-radius:10px;
  box-shadow:0 0 30px #000;
  overflow:hidden;
  resize:both;
  min-width:260px;
  min-height:180px;
}

.titlebar {
  height:38px;
  background:#0b0f15;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 10px;
  cursor:move;
  color:#cbd5e1;
  font-weight:500;
  border-bottom:1px solid #1f2937;
}

.controls button {
  width:28px;
  height:28px;
  margin-left:6px;
  border:none;
  border-radius:6px;
  background:#111827;
  color:#cbd5e1;
  cursor:pointer;
}
.controls button:hover {
  background:#1f2937;
}

.content {
  height:calc(100% - 38px);
  background:#020617;
}

iframe, textarea {
  width:100%; height:100%;
  border:none;
  background:#020617;
  color:white;
}

/* Taskbar */
#taskbar {
  position:absolute;
  bottom:0; left:0; right:0;
  height:48px;
  background:#05080f;
  border-top:1px solid #111827;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 12px;
}

#apps {
  display:flex;
  gap:14px;
  justify-content:center;
  flex:1;
}

.appicon {
  width:38px;
  height:38px;
  border-radius:10px;
  background:#0f172a;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#e2e8f0;
  font-size:13px;
  cursor:pointer;
  position:relative;
}
.appicon.open::after {
  content:"";
  position:absolute;
  bottom:2px;
  width:16px;
  height:3px;
  background:#3b82f6;
  border-radius:2px;
}

#clock {
  font-size:12px;
  color:#94a3b8;
  text-align:right;
  min-width:120px;
}

.noselect { user-select:none; }
</style>
</head>
<body>

<div id="desktop"></div>

<div id="taskbar">
  <div style="color:#334155;font-size:12px">NextVG OS</div>
  <div id="apps"></div>
  <div id="clock"></div>
</div>

<script>
document.addEventListener("contextmenu", e => e.preventDefault());

const desktop = document.getElementById("desktop");
const appsBar = document.getElementById("apps");
const clock = document.getElementById("clock");

let topZ = 10;

function b64(s){ return atob(s); }

const icons = {
  browser:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#7dd3fc" fill="none" stroke-width="2"><circle cx="12" cy="12" r="9"/><path d="M3 12h18M12 3a15 15 0 010 18"/></svg>`,
  kb:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#a78bfa" fill="none" stroke-width="2"><rect x="3" y="4" width="18" height="14" rx="2"/><path d="M7 8v4M11 8v4M15 8v4"/></svg>`,
  google:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#facc15" fill="none" stroke-width="2"><circle cx="12" cy="12" r="9"/><path d="M16 12h-4v4"/></svg>`,
  rammer:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#f43f5e" fill="none" stroke-width="2"><path d="M4 20l16-8L4 4v16z"/></svg>`,
  games:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#4ade80" fill="none" stroke-width="2"><rect x="3" y="6" width="18" height="12" rx="3"/><path d="M8 12h4M10 10v4M16 11h.01M18 13h.01"/></svg>`,
  eagler:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#38bdf8" fill="none" stroke-width="2"><path d="M3 12l9-9 9 9-9 9-9-9z"/></svg>`,
  settings:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#94a3b8" fill="none" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.7 1.7 0 000-6M4.6 9a1.7 1.7 0 000 6"/></svg>`,
  editor:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#f472b6" fill="none" stroke-width="2"><path d="M4 4h16v16H4z"/><path d="M8 8h8M8 12h8M8 16h5"/></svg>`,
  readme:`<svg viewBox="0 0 24 24" width="22" height="22" stroke="#c084fc" fill="none" stroke-width="2"><path d="M6 3h9l3 3v15H6z"/><path d="M9 10h6M9 14h6"/></svg>`
};

const appList = [
  ["NextBrowser","NXB","aHR0cHM6Ly85Mjg1MC52ZXJjZWwuYXBw",icons.browser],
  ["KB Browser","KBB","aHR0cHM6Ly9rYnNpZ21hYm95NjctcHJvamVjdC5ib2x0Lmhvc3Q=",icons.kb],
  ["Google","GGL","aHR0cHM6Ly9nb29nbGUuY29tP2lndT0x",icons.google],
  ["RammerHead","RHM","aHR0cHM6Ly9lZmx5LjEwOC0xODEtMzItNzcuc3NsaXAuaW8=",icons.rammer],
  ["PeteZah","PZG","aHR0cHM6Ly90dWJtbGVkeGVuaS52aWFyM2QuY29t",icons.games],
  ["Eagler 1.12","EGL","aHR0cHM6Ly9rYnNpZ21hYm95NjcuZ2l0aHViLmlvL21jLzEuMTI=",icons.eagler],
  ["Settings","SET","settings",icons.settings],
  ["Editor","EDT","editor",icons.editor],
  ["README","RDM","readme",icons.readme]
];

const windows = {};

function bringToFront(win){
  win.style.zIndex = ++topZ;
}

function createWindow(id,title,content){
  if(windows[id]) return toggle(id);

  const win = document.createElement("div");
  win.className = "window";
  win.style.width = "540px";
  win.style.height = "380px";
  win.style.left = Math.random()*200+80+"px";
  win.style.top = Math.random()*120+60+"px";
  win.style.zIndex = ++topZ;

  win.onclick = () => bringToFront(win);

  const bar = document.createElement("div");
  bar.className = "titlebar";
  bar.innerHTML = `<span>${title}</span>`;

  const ctr = document.createElement("div");
  ctr.className = "controls";
  ctr.innerHTML = `<button>–</button><button>▢</button><button>✕</button>`;
  bar.appendChild(ctr);

  const body = document.createElement("div");
  body.className = "content";

  if(content === "settings"){
    body.innerHTML = `<iframe srcdoc="
      <style>body{background:#020617;color:#cbd5e1;font-family:sans-serif;padding:16px}</style>
      <h2>NextVG OS</h2>
      <p>Gaming Edition</p>
      <p>Made by kbsigmaboy67</p>
      <button onclick='parent.openBlob()'>Launch OS in Blob Popup</button><br><br>
      <input type=file onchange='parent.setBg(this.files[0])'>
    "></iframe>`;
  }
  else if(content === "editor"){
    body.innerHTML = `
      <textarea id="editor" style="width:100%;height:100%;background:#020617;color:#e2e8f0;border:none;padding:10px;font-family:monospace;"></textarea>
      <button style="position:absolute;bottom:10px;right:10px;background:#0f172a;color:white;border:1px solid #334155;padding:6px;border-radius:6px"
        onclick="parent.openEditorBlob()">Run in Blob</button>`;
  }
  else if(content === "readme"){
    body.innerHTML = `<iframe srcdoc="
      <style>body{background:#020617;color:#cbd5e1;font-family:sans-serif;padding:18px;line-height:1.6}</style>
      <b>README</b><br><br>
      go to &quot;https://cloudmoonapp.com&quot; or &quot;https://now.gg&quot; on NextBrowser<br>
      check out my YouTube! @kbsigmaboy67<br>
      email me at kbsigmaboy67@gmail.com<br>
      check out my GitHub! https://GitHub.com/kbsigmaboy67<br><br>
      credits: Keagan, J.T., Ryder, Joe/Baca, KB's school gang, and everyone who helped make the proxies here.<br><br>
      nobody involved in this project is responsible for the use of any proxies here.
    "></iframe>`;
  }
  else {
    const iframe = document.createElement("iframe");
    iframe.src = b64(content);
    body.appendChild(iframe);
  }

  win.append(bar, body);
  desktop.appendChild(win);
  windows[id] = win;

  let ox, oy, drag = false;
  bar.onmousedown = e => { drag=true; bringToFront(win); ox=e.clientX-win.offsetLeft; oy=e.clientY-win.offsetTop; };
  window.onmouseup = () => drag=false;
  window.onmousemove = e => drag && (win.style.left=e.clientX-ox+"px", win.style.top=e.clientY-oy+"px");

  ctr.children[0].onclick = () => win.style.display="none";
  ctr.children[1].onclick = () => {
    if(win.dataset.full){
      win.style.width="540px"; win.style.height="380px"; win.dataset.full="";
    } else {
      win.style.left="0"; win.style.top="0"; win.style.width="100%"; win.style.height="100%"; win.dataset.full="1";
    }
  };
  ctr.children[2].onclick = () => { win.remove(); delete windows[id]; updateIcons(); };

  updateIcons();
}

function toggle(id){
  const w = windows[id];
  w.style.display = (w.style.display === "none") ? "block" : "none";
  bringToFront(w);
}

function updateIcons(){
  document.querySelectorAll(".appicon").forEach(i=>{
    i.classList.toggle("open", windows[i.dataset.id]);
  });
}

appList.forEach(([name,id,url,icon])=>{
  const iconDiv = document.createElement("div");
  iconDiv.className = "appicon";
  iconDiv.dataset.id = id;
  iconDiv.innerHTML = icon;
  iconDiv.title = name;
  iconDiv.onclick = () => createWindow(id,name,url);
  appsBar.appendChild(iconDiv);
});

function openBlob(){
  const blob = new Blob([document.documentElement.outerHTML],{type:"text/html"});
  open(URL.createObjectURL(blob));
}

function setBg(file){
  const r = new FileReader();
  r.onload = e => desktop.style.backgroundImage = `url(${e.target.result})`;
  r.readAsDataURL(file);
}

function openEditorBlob(){
  const text = document.getElementById("editor")?.value || "";
  const blob = new Blob([text],{type:"text/html"});
  open(URL.createObjectURL(blob));
}

setInterval(()=>{
  const d = new Date();
  clock.textContent = d.toLocaleTimeString() + " " + d.toLocaleDateString();
},1000);
</script>


</body>
</html>
