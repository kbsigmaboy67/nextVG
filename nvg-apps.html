<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NextVG Apps</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* (CSS unchanged — omitted here for brevity)
   KEEP YOUR PREVIOUS CSS EXACTLY THE SAME */
</style>
</head>

<body>
<header>
  <h1>NextVG Apps</h1>
  <span>made by kbsigmaboy67</span>
</header>

<div class="search-wrap">
  <input id="search" placeholder="Search apps..." autocomplete="off">
</div>

<div id="content"></div>

<footer>
  Dark • Smooth • RGB Pro Gamer
</footer>

<script>
/* ============================
   EDIT YOUR APPS HERE
============================ */
const apps = [
  {
    name: "GamesGG",
    category: "Games / MiniGames",
    type: "url",
    src: "https://example.com",
    icon: "https://www.google.com/favicon.ico",
    theme: "rgb(120,80,255)"
  }
];

/* ============================
   RENDER
============================ */
const content = document.getElementById("content");
const search = document.getElementById("search");

function normalize(str) {
  return str.toLowerCase().replace(/\s+/g, "");
}

function render(filter = "") {
  content.innerHTML = "";
  const f = normalize(filter);
  const categories = [...new Set(apps.map(a => a.category))];

  categories.forEach(cat => {
    const catApps = apps.filter(a =>
      a.category === cat &&
      normalize(a.name).startsWith(f)
    );
    if (!catApps.length) return;

    const section = document.createElement("div");
    section.className = "category";
    section.innerHTML = `<h2>${cat}</h2><div class="grid"></div>`;

    const grid = section.querySelector(".grid");

    catApps.forEach(app => {
      const el = document.createElement("div");
      el.className = "app";
      el.style.setProperty("--theme", app.theme);
      el.innerHTML = `
        <div class="icon-wrap">
          <div class="icon">
            <img src="${app.icon}">
          </div>
        </div>
        <div class="name">${app.name}</div>
      `;
      el.onclick = () => openApp(app);
      grid.appendChild(el);
    });

    content.appendChild(section);
  });
}

search.oninput = () => render(search.value);
render();

/* ============================
   APP OPEN LOGIC (FIXED)
============================ */
async function openApp(app) {
  let html = "";

  if (app.type === "url") {
    html = `<iframe src="${app.src}"
      style="border:0;width:100%;height:100%"
      sandbox="allow-scripts allow-forms allow-same-origin">
    <\/iframe>`;
  }

  if (app.type === "base64") {
    html = atob(app.src);
  }

  if (app.type === "file") {
    const res = await fetch(app.src);
    html = await res.text();
  }

  const doc = `
<!DOCTYPE html>
<html>
<body style="margin:0;background:black">
<iframe name="embed:d"
  style="border:0;width:100%;height:100%"
  sandbox="allow-scripts allow-forms allow-same-origin">
<\/iframe>
<script>
document.oncontextmenu = () => false;
const iframe = document.querySelector("iframe");
iframe.srcdoc = \`${html.replace(/`/g,"\\`")}\`;
<\/script>
</body>
</html>`;

  const blob = new Blob([doc], { type: "text/html" });
  const url = URL.createObjectURL(blob);

  window.open(url, "_blank", "popup=yes,width=1200,height=700");
}
</script>
</body>
</html>
